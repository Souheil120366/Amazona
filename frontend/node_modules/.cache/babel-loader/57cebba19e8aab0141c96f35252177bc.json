{"ast":null,"code":"import _regeneratorRuntime from\"/home/souheil/Projects/Amazona/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/souheil/Projects/Amazona/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/souheil/Projects/Amazona/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import React,{useContext,useEffect,useRef,useState}from'react';import{LoadScript,GoogleMap,StandaloneSearchBox,Marker}from'@react-google-maps/api';import{useNavigate}from'react-router-dom';import{Store}from'../Store';import Button from'react-bootstrap/Button';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var defaultLocation={lat:45.516,lng:-73.56};var libs=['places'];export default function MapScreen(){var requestUrl=\"https://www.skftechnologies.com:5000\";//const requestUrl = \"\";\nvar _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var userInfo=state.userInfo;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),googleApiKey=_useState2[0],setGoogleApiKey=_useState2[1];var _useState3=useState(defaultLocation),_useState4=_slicedToArray(_useState3,2),center=_useState4[0],setCenter=_useState4[1];var _useState5=useState(center),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var mapRef=useRef(null);var placeRef=useRef(null);var markerRef=useRef(null);var getUserCurrentLocation=function getUserCurrentLocation(){if(!navigator.geolocation){alert('Geolocation os not supported by this browser');}else{navigator.geolocation.getCurrentPosition(function(position){setCenter({lat:position.coords.latitude,lng:position.coords.longitude});setLocation({lat:position.coords.latitude,lng:position.coords.longitude});});}};useEffect(function(){var fetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios(requestUrl+'/api/keys/google',{headers:{Authorization:\"BEARER \".concat(userInfo.token)}});case 2:_yield$axios=_context.sent;data=_yield$axios.data;setGoogleApiKey(data.key);getUserCurrentLocation();case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetch(){return _ref.apply(this,arguments);};}();fetch();ctxDispatch({type:'SET_FULLBOX_ON'});},[ctxDispatch]);var onLoad=function onLoad(map){mapRef.current=map;};var onIdle=function onIdle(){setLocation({lat:mapRef.current.center.lat(),lng:mapRef.current.center.lng()});};var onLoadPlaces=function onLoadPlaces(place){placeRef.current=place;};var onPlacesChanged=function onPlacesChanged(){var place=placeRef.current.getPlaces()[0].geometry.location;setCenter({lat:place.lat(),lng:place.lng()});setLocation({lat:place.lat(),lng:place.lng()});};var onMarkerLoad=function onMarkerLoad(marker){markerRef.current=marker;};var onConfirm=function onConfirm(){var places=placeRef.current.getPlaces()||[{}];ctxDispatch({type:'SAVE_SHIPPING_ADDRESS_MAP_LOCATION',payload:{lat:location.lat,lng:location.lng,address:places[0].formatted_address,name:places[0].name,vicinity:places[0].vicinity,googleAddressId:places[0].id}});toast.success('location selected successfully.');navigate('/shipping');};return/*#__PURE__*/_jsx(\"div\",{className:\"full-box\",children:/*#__PURE__*/_jsx(LoadScript,{libraries:libs,googleMapsApiKey:googleApiKey,children:/*#__PURE__*/_jsxs(GoogleMap,{id:\"smaple-map\",mapContainerStyle:{height:'100%',width:'100%'},center:center,zoom:15,onLoad:onLoad,onIdle:onIdle,children:[/*#__PURE__*/_jsx(StandaloneSearchBox,{onLoad:onLoadPlaces,onPlacesChanged:onPlacesChanged,children:/*#__PURE__*/_jsxs(\"div\",{className:\"map-input-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter your address\"}),/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:onConfirm,children:\"Confirm\"})]})}),/*#__PURE__*/_jsx(Marker,{position:location,onLoad:onMarkerLoad})]})})});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useRef","useState","LoadScript","GoogleMap","StandaloneSearchBox","Marker","useNavigate","Store","Button","toast","defaultLocation","lat","lng","libs","MapScreen","requestUrl","state","ctxDispatch","dispatch","userInfo","navigate","googleApiKey","setGoogleApiKey","center","setCenter","location","setLocation","mapRef","placeRef","markerRef","getUserCurrentLocation","navigator","geolocation","alert","getCurrentPosition","position","coords","latitude","longitude","fetch","headers","Authorization","token","data","key","type","onLoad","map","current","onIdle","onLoadPlaces","place","onPlacesChanged","getPlaces","geometry","onMarkerLoad","marker","onConfirm","places","payload","address","formatted_address","name","vicinity","googleAddressId","id","success","height","width"],"sources":["/home/souheil/Projects/Amazona/frontend/src/screens/MapScreen.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport {\n  LoadScript,\n  GoogleMap,\n  StandaloneSearchBox,\n  Marker,\n} from '@react-google-maps/api';\nimport { useNavigate } from 'react-router-dom';\nimport { Store } from '../Store';\nimport Button from 'react-bootstrap/Button';\nimport { toast } from 'react-toastify';\n\nconst defaultLocation = { lat: 45.516, lng: -73.56 };\nconst libs = ['places'];\n\nexport default function MapScreen() {\n  const requestUrl = \"https://www.skftechnologies.com:5000\";\n  //const requestUrl = \"\";\n  const { state, dispatch: ctxDispatch } = useContext(Store);\n  const { userInfo } = state;\n  const navigate = useNavigate();\n  const [googleApiKey, setGoogleApiKey] = useState('');\n  const [center, setCenter] = useState(defaultLocation);\n  const [location, setLocation] = useState(center);\n\n  const mapRef = useRef(null);\n  const placeRef = useRef(null);\n  const markerRef = useRef(null);\n\n  const getUserCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      alert('Geolocation os not supported by this browser');\n    } else {\n      navigator.geolocation.getCurrentPosition((position) => {\n        setCenter({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n        setLocation({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n      });\n    }\n  };\n  useEffect(() => {\n    const fetch = async () => {\n      const { data } = await axios(requestUrl+'/api/keys/google', {\n        headers: { Authorization: `BEARER ${userInfo.token}` },\n      });\n      setGoogleApiKey(data.key);\n      getUserCurrentLocation();\n    };\n\n    fetch();\n    ctxDispatch({\n      type: 'SET_FULLBOX_ON',\n    });\n  }, [ctxDispatch]);\n\n  const onLoad = (map) => {\n    mapRef.current = map;\n  };\n  const onIdle = () => {\n    setLocation({\n      lat: mapRef.current.center.lat(),\n      lng: mapRef.current.center.lng(),\n    });\n  };\n\n  const onLoadPlaces = (place) => {\n    placeRef.current = place;\n  };\n  const onPlacesChanged = () => {\n    const place = placeRef.current.getPlaces()[0].geometry.location;\n    setCenter({ lat: place.lat(), lng: place.lng() });\n    setLocation({ lat: place.lat(), lng: place.lng() });\n  };\n\n  const onMarkerLoad = (marker) => {\n    markerRef.current = marker;\n  };\n\n  const onConfirm = () => {\n    const places = placeRef.current.getPlaces() || [{}];\n    ctxDispatch({\n      type: 'SAVE_SHIPPING_ADDRESS_MAP_LOCATION',\n      payload: {\n        lat: location.lat,\n        lng: location.lng,\n        address: places[0].formatted_address,\n        name: places[0].name,\n        vicinity: places[0].vicinity,\n        googleAddressId: places[0].id,\n      },\n    });\n    toast.success('location selected successfully.');\n    navigate('/shipping');\n  };\n  return (\n    <div className=\"full-box\">\n      <LoadScript libraries={libs} googleMapsApiKey={googleApiKey}>\n        <GoogleMap\n          id=\"smaple-map\"\n          mapContainerStyle={{ height: '100%', width: '100%' }}\n          center={center}\n          zoom={15}\n          onLoad={onLoad}\n          onIdle={onIdle}\n        >\n          <StandaloneSearchBox\n            onLoad={onLoadPlaces}\n            onPlacesChanged={onPlacesChanged}\n          >\n            <div className=\"map-input-box\">\n              <input type=\"text\" placeholder=\"Enter your address\"></input>\n              <Button type=\"button\" onClick={onConfirm}>\n                Confirm\n              </Button>\n            </div>\n          </StandaloneSearchBox>\n          <Marker position={location} onLoad={onMarkerLoad}></Marker>\n        </GoogleMap>\n      </LoadScript>\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}