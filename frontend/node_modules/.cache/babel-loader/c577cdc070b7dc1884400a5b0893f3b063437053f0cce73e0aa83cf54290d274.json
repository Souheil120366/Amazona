{"ast":null,"code":"import React from'react';import{useNavigate,useParams}from'react-router-dom';import axios from'axios';import{useContext,useEffect,useReducer}from'react';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Card from'react-bootstrap/Card';import ListGroup from'react-bootstrap/ListGroup';import Badge from'react-bootstrap/Badge';import Button from'react-bootstrap/Button';import Rating from'../components/Rating';import{Helmet}from'react-helmet-async';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{getError}from'../utils';import{Store}from'../Store';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const reducer=(state,action)=>{switch(action.type){case'FETCH_REQUEST':return{...state,loading:true};case'FETCH_SUCCESS':return{...state,product:action.payload,loading:false};case'FETCH_FAIL':return{...state,loading:false,error:action.payload};default:return state;}};function ProductScreen(){//const requestUrl = 'https://www.skftechnologies.com:5000';\nconst requestUrl=process.env.REACT_APP_API_URL;const navigate=useNavigate();const params=useParams();const{slug}=params;const[{loading,error,product},dispatch]=useReducer(reducer,{product:[],loading:true,error:''});useEffect(()=>{const fetchData=async()=>{dispatch({type:'FETCH_REQUEST'});try{const result=await axios.get(requestUrl+`/api/products/slug/${slug}`);dispatch({type:'FETCH_SUCCESS',payload:result.data});}catch(err){dispatch({type:'FETCH_FAIL',payload:getError(err)});}};fetchData();},[slug]);const{state,dispatch:ctxDispatch}=useContext(Store);const{cart}=state;const addToCartHandler=async()=>{const existItem=cart.cartItems.find(x=>x._id===product._id);const quantity=existItem?existItem.quantity+1:1;const{data}=await axios.get(requestUrl+`/api/products/${product._id}`);if(data.countInStock<quantity){window.alert('Sorry. Product is out of stock');return;}ctxDispatch({type:'CART_ADD_ITEM',payload:{...product,quantity}});navigate('/cart');};return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})}),/*#__PURE__*/_jsx(\"h1\",{children:product.name})]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Price : \",product.price,\" TND\"]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Description:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Price:\"}),/*#__PURE__*/_jsxs(Col,{children:[product.price,\" TND\"]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{children:product.countInStock>0?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"In Stock\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Unavailable\"})})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,variant:\"primary\",children:\"Add to Cart\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["React","useNavigate","useParams","axios","useContext","useEffect","useReducer","Row","Col","Card","ListGroup","Badge","Button","Rating","Helmet","LoadingBox","MessageBox","getError","Store","jsx","_jsx","jsxs","_jsxs","reducer","state","action","type","loading","product","payload","error","ProductScreen","requestUrl","process","env","REACT_APP_API_URL","navigate","params","slug","dispatch","fetchData","result","get","data","err","ctxDispatch","cart","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","variant","children","md","className","src","image","alt","name","Item","rating","numReviews","price","description","Body","bg","onClick"],"sources":["C:/Users/User/Amazona/frontend/src/screens/ProductScreen.js"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useContext, useEffect, useReducer } from 'react';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Card from 'react-bootstrap/Card';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Rating from '../components/Rating';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\nimport { getError } from '../utils';\r\nimport { Store } from '../Store';\r\n\r\n\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'FETCH_REQUEST':\r\n      return { ...state, loading: true };\r\n    case 'FETCH_SUCCESS':\r\n      return { ...state, product: action.payload, loading: false };\r\n    case 'FETCH_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nfunction ProductScreen() {\r\n  //const requestUrl = 'https://www.skftechnologies.com:5000';\r\n  const requestUrl = process.env.REACT_APP_API_URL;\r\n  const navigate = useNavigate();\r\n  const params = useParams();\r\n  const { slug } = params;\r\n  const [{ loading, error, product }, dispatch] = useReducer(reducer, {\r\n    product: [],\r\n    loading: true,\r\n    error: '',\r\n  });\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      dispatch({ type: 'FETCH_REQUEST' });\r\n      try {\r\n        const result = await axios.get(\r\n          requestUrl + `/api/products/slug/${slug}`\r\n        );\r\n        dispatch({ type: 'FETCH_SUCCESS', payload: result.data });\r\n      } catch (err) {\r\n        dispatch({ type: 'FETCH_FAIL', payload: getError(err) });\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [slug]);\r\n  const { state, dispatch: ctxDispatch } = useContext(Store);\r\n\r\n  const { cart } = state;\r\n  const addToCartHandler = async () => {\r\n    const existItem = cart.cartItems.find((x) => x._id === product._id);\r\n    const quantity = existItem ? existItem.quantity + 1 : 1;\r\n    const { data } = await axios.get(\r\n      requestUrl + `/api/products/${product._id}`\r\n    );\r\n    if (data.countInStock < quantity) {\r\n      window.alert('Sorry. Product is out of stock');\r\n      return;\r\n    }\r\n    ctxDispatch({\r\n      type: 'CART_ADD_ITEM',\r\n      payload: { ...product, quantity },\r\n    });\r\n    navigate('/cart');\r\n  };\r\n  return loading ? (\r\n    <LoadingBox />\r\n  ) : error ? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n  ) : (\r\n    <div>\r\n     \r\n      <Row>\r\n        <Col md={3}>\r\n          <img\r\n            className=\"img-large\"\r\n            src={product.image}\r\n            alt={product.name}\r\n          ></img>\r\n        </Col>\r\n        <Col md={6}>\r\n          <ListGroup variant=\"flush\">\r\n            <ListGroup.Item>\r\n              <Helmet>\r\n                <title>{product.name}</title>\r\n              </Helmet>\r\n              <h1>{product.name}</h1>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <Rating\r\n                rating={product.rating}\r\n                numReviews={product.numReviews}\r\n              ></Rating>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>Price : {product.price} TND</ListGroup.Item>\r\n            <ListGroup.Item>\r\n              Description:\r\n              <p>{product.description}</p>\r\n            </ListGroup.Item>\r\n          </ListGroup>\r\n        </Col>\r\n        <Col md={3}>\r\n          <Card>\r\n            <Card.Body>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Price:</Col>\r\n                    <Col>{product.price} TND</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Status:</Col>\r\n                    <Col>\r\n                      {product.countInStock > 0 ? (\r\n                        <Badge bg=\"success\">In Stock</Badge>\r\n                      ) : (\r\n                        <Badge bg=\"danger\">Unavailable</Badge>\r\n                      )}\r\n                    </Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n\r\n                {product.countInStock > 0 && (\r\n                  <ListGroup.Item>\r\n                    <div className=\"d-grid\">\r\n                      <Button onClick={addToCartHandler} variant=\"primary\">\r\n                        Add to Cart\r\n                      </Button>\r\n                    </div>\r\n                  </ListGroup.Item>\r\n                )}\r\n              </ListGroup>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\nexport default ProductScreen;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}