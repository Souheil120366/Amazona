{"ast":null,"code":"import axios from'axios';import React,{useContext,useEffect,useReducer,useState}from'react';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import Container from'react-bootstrap/Container';import{Helmet}from'react-helmet-async';import{useNavigate,useParams}from'react-router-dom';import{toast}from'react-toastify';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{Store}from'../Store';import{getError}from'../utils';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const reducer=(state,action)=>{switch(action.type){case'FETCH_REQUEST':return{...state,loading:true};case'FETCH_SUCCESS':return{...state,loading:false};case'FETCH_FAIL':return{...state,loading:false,error:action.payload};case'UPDATE_REQUEST':return{...state,loadingUpdate:true};case'UPDATE_SUCCESS':return{...state,loadingUpdate:false};case'UPDATE_FAIL':return{...state,loadingUpdate:false};default:return state;}};export default function UserEditScreen(){//const requestUrl = \"https://www.skftechnologies.com:5000\";\nconst requestUrl=process.env.REACT_APP_API_URL;const[{loading,error,loadingUpdate},dispatch]=useReducer(reducer,{loading:true,error:''});const{state}=useContext(Store);const{userInfo}=state;const params=useParams();const{id:userId}=params;const navigate=useNavigate();const[name,setName]=useState('');const[email,setEmail]=useState('');const[phone,setPhone]=useState('');const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{const fetchData=async()=>{try{dispatch({type:'FETCH_REQUEST'});const{data}=await axios.get(requestUrl+`/api/users/${userId}`,{headers:{Authorization:`Bearer ${userInfo.token}`}});setName(data.name);setEmail(data.email);setPhone(data.phone);setIsAdmin(data.isAdmin);dispatch({type:'FETCH_SUCCESS'});}catch(err){dispatch({type:'FETCH_FAIL',payload:getError(err)});}};fetchData();},[userId,userInfo]);const submitHandler=async e=>{e.preventDefault();try{dispatch({type:'UPDATE_REQUEST'});await axios.put(requestUrl+`/api/users/${userId}`,{_id:userId,name,email,isAdmin},{headers:{Authorization:`Bearer ${userInfo.token}`}});dispatch({type:'UPDATE_SUCCESS'});toast.success('User updated successfully');navigate('/admin/users');}catch(error){toast.error(getError(error));dispatch({type:'UPDATE_FAIL'});}};return/*#__PURE__*/_jsxs(Container,{className:\"small-container\",children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsxs(\"title\",{children:[\"Edit User $\",userId]})}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Edit User \",userId]}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{value:name,onChange:e=>setName(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{value:email,type:\"email\",onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"phone\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Phone\"}),/*#__PURE__*/_jsx(Form.Control,{value:phone,type:\"email\",onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsx(Form.Check,{className:\"mb-3\",type:\"checkbox\",id:\"isAdmin\",label:\"isAdmin\",checked:isAdmin,onChange:e=>setIsAdmin(e.target.checked)}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{disabled:loadingUpdate,type:\"submit\",children:\"Update\"}),loadingUpdate&&/*#__PURE__*/_jsx(LoadingBox,{})]})]})]});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useReducer","useState","Form","Button","Container","Helmet","useNavigate","useParams","toast","LoadingBox","MessageBox","Store","getError","jsxs","_jsxs","jsx","_jsx","reducer","state","action","type","loading","error","payload","loadingUpdate","UserEditScreen","requestUrl","process","env","REACT_APP_API_URL","dispatch","userInfo","params","id","userId","navigate","name","setName","email","setEmail","phone","setPhone","isAdmin","setIsAdmin","fetchData","data","get","headers","Authorization","token","err","submitHandler","e","preventDefault","put","_id","success","className","children","variant","onSubmit","Group","controlId","Label","Control","value","onChange","target","required","Check","label","checked","disabled"],"sources":["C:/Users/User/Amazona/frontend/src/screens/UserEditScreen.js"],"sourcesContent":["import axios from 'axios';\r\nimport React, { useContext, useEffect, useReducer, useState } from 'react';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Container from 'react-bootstrap/Container';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\nimport { Store } from '../Store';\r\nimport { getError } from '../utils';\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'FETCH_REQUEST':\r\n      return { ...state, loading: true };\r\n    case 'FETCH_SUCCESS':\r\n      return { ...state, loading: false };\r\n    case 'FETCH_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    case 'UPDATE_REQUEST':\r\n      return { ...state, loadingUpdate: true };\r\n    case 'UPDATE_SUCCESS':\r\n      return { ...state, loadingUpdate: false };\r\n    case 'UPDATE_FAIL':\r\n      return { ...state, loadingUpdate: false };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default function UserEditScreen() {\r\n  //const requestUrl = \"https://www.skftechnologies.com:5000\";\r\n  const requestUrl = process.env.REACT_APP_API_URL;\r\n  const [{ loading, error, loadingUpdate }, dispatch] = useReducer(reducer, {\r\n    loading: true,\r\n    error: '',\r\n  });\r\n\r\n  const { state } = useContext(Store);\r\n  const { userInfo } = state;\r\n\r\n  const params = useParams();\r\n  const { id: userId } = params;\r\n  const navigate = useNavigate();\r\n\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        dispatch({ type: 'FETCH_REQUEST' });\r\n        const { data } = await axios.get(requestUrl+`/api/users/${userId}`, {\r\n          headers: { Authorization: `Bearer ${userInfo.token}` },\r\n        });\r\n        setName(data.name);\r\n        setEmail(data.email);\r\n        setPhone(data.phone);\r\n        setIsAdmin(data.isAdmin);\r\n        dispatch({ type: 'FETCH_SUCCESS' });\r\n      } catch (err) {\r\n        dispatch({\r\n          type: 'FETCH_FAIL',\r\n          payload: getError(err),\r\n        });\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [userId, userInfo]);\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      dispatch({ type: 'UPDATE_REQUEST' });\r\n      await axios.put(\r\n        requestUrl+`/api/users/${userId}`,\r\n        { _id: userId, name, email, isAdmin },\r\n        {\r\n          headers: { Authorization: `Bearer ${userInfo.token}` },\r\n        }\r\n      );\r\n      dispatch({\r\n        type: 'UPDATE_SUCCESS',\r\n      });\r\n      toast.success('User updated successfully');\r\n      navigate('/admin/users');\r\n    } catch (error) {\r\n      toast.error(getError(error));\r\n      dispatch({ type: 'UPDATE_FAIL' });\r\n    }\r\n  };\r\n  return (\r\n    <Container className=\"small-container\">\r\n      <Helmet>\r\n        <title>Edit User ${userId}</title>\r\n      </Helmet>\r\n      <h1>Edit User {userId}</h1>\r\n\r\n      {loading ? (\r\n        <LoadingBox></LoadingBox>\r\n      ) : error ? (\r\n        <MessageBox variant=\"danger\">{error}</MessageBox>\r\n      ) : (\r\n        <Form onSubmit={submitHandler}>\r\n          <Form.Group className=\"mb-3\" controlId=\"name\">\r\n            <Form.Label>Name</Form.Label>\r\n            <Form.Control\r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              required\r\n            />\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"email\">\r\n            <Form.Label>Email</Form.Label>\r\n            <Form.Control\r\n              value={email}\r\n              type=\"email\"\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              required\r\n            />\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"phone\">\r\n            <Form.Label>Phone</Form.Label>\r\n            <Form.Control\r\n              value={phone}\r\n              type=\"email\"\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              required\r\n            />\r\n          </Form.Group>\r\n\r\n          <Form.Check\r\n            className=\"mb-3\"\r\n            type=\"checkbox\"\r\n            id=\"isAdmin\"\r\n            label=\"isAdmin\"\r\n            checked={isAdmin}\r\n            onChange={(e) => setIsAdmin(e.target.checked)}\r\n          />\r\n\r\n          <div className=\"mb-3\">\r\n            <Button disabled={loadingUpdate} type=\"submit\">\r\n              Update\r\n            </Button>\r\n            {loadingUpdate && <LoadingBox></LoadingBox>}\r\n          </div>\r\n        </Form>\r\n      )}\r\n    </Container>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}